<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <style>
  body{
      font-family: "helvetica";
    }

    svg {
        box-sizing: content-box
    }

   .selected{
      stroke: red;
      fill: red
    }
  </style>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src='../data/day4.js'></script>
  <body>
    <script>
    const data = circle_data
    var initWidth = 340
    var initHeight = 500

    var padding = { left:40, top:10, right:10, bottom: 20}

    var height = initWidth - padding.top - padding.bottom
    var width  = initHeight - padding.left - padding.right


    var svg = d3.select("body")
                .append("svg")
                .attr("width", width)
                .attr("height", height)
                .style("padding-left", padding.left)
                .style("padding-right", padding.right)
                .style("padding-top", padding.top)
                .style("padding-bottom", padding.bottom)
    

     //添加y轴坐标轴 
        
        //y轴比例尺
        let ydata = data.map(function(e, i){ return e[1]})
        let yScale = d3.scaleLinear()
         .domain([0, d3.max(ydata)])
         .range([height , 0]);
         
         let _yScale = d3.scaleLinear()
         .domain([0, d3.max(ydata)])
         .range([0, height]); 

        //定义y轴
        let yAxis = d3.axisLeft(yScale);

        //添加y轴
        svg.append("g")
        .attr("class","axis")
        .attr("transform","translate(" + 0 + "," + 0 + ")")
        .call(yAxis);

     //添加x轴坐标轴

         //x轴比例尺
         let xData = data.map(function(e, i){ return e[0]})
         let xScale = d3.scaleBand()
                        .domain(xData)
                        .rangeRound([0, width])
                        .padding(0.1)
        //定义x轴
        let xAxis = d3.axisBottom(xScale)
        
        //添加x轴
         svg.append("g")
            .attr("class","axis--x")
            .attr("transform","translate(" + "0 ," + height + ")")
            .call(xAxis);

        var circle = svg.selectAll("circle")
                        .data(data)
                        .enter()
                        .append("circle")
                        .attr("fill", "steelblue")
                        .attr("cx", function(d){ return xScale(d[0]) })
                        .attr("cy", function(d){ return height - _yScale(d[1]) })
                        .attr("r", 3)

       var brush = svg.append("g")
                .attr("class", "brush")
                .call(d3.brush()
                    .on("brush", function(e) {
                        var slect = d3.event.selection; 
                        circle.attr("class",function(d){
                            let x = xScale(d[0])
                            let y = height - _yScale(d[1])
                            return  x >= slect[0][0] && x <= slect[1][0] && y >= slect[0][1] && y <= slect[1][1] ? "selected" : ""
                        })

                    })
            )
      


    </script>
  </body>
</html>
